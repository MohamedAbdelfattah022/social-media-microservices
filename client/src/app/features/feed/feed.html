<div class="min-h-screen p-4 pb-20" appInfiniteScroll (scrolled)="loadMore()">
  <div class="max-w-2xl mx-auto flex flex-col gap-4">
    <!-- Post Cards -->
    @for (post of posts(); track post.id) {
      <div>
        <app-post-card [data]="post" (postDeleted)="onPostDeleted($event)" />
      </div>
    }

    <!-- Initial Loading Skeletons -->
    @if ((isLoading() && posts().length === 0) || (isLoading() && posts().length > 0)) {
      <app-loading-skeleton />
    }

    <!-- Empty State -->
    @if (posts().length === 0 && !isLoading() && !error()) {
      <div
        class="text-center py-20 px-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-gray-100 mt-12"
      >
        <div
          class="w-20 h-20 mx-auto mb-6 bg-linear-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center"
        >
          <z-icon zType="users" zSize="lg" class="text-blue-500" />
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">No posts yet</h3>
        @if (userId()) {
          <p class="text-gray-500 text-lg">This user hasn't posted anything yet.</p>
        } @else {
          <p class="text-gray-500 text-lg">Follow some people to see their posts here!</p>
        }
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div
        role="alert"
        class="text-center py-12 px-8 bg-linear-to-br from-red-50 to-orange-50 rounded-3xl shadow-xl border-2 border-red-200 mt-12"
      >
        <div
          class="w-16 h-16 mx-auto mb-5 bg-red-100 rounded-full flex items-center justify-center"
        >
          <z-icon zType="circle-alert" zSize="lg" class="text-red-500 w-9 h-9" />
        </div>
        <p class="text-xl font-bold text-red-700 mb-2">Oops! Something went wrong</p>
        <p class="text-red-600 mb-6">{{ error() }}</p>
        <button
          (click)="loadMore()"
          class="group px-8 py-3 bg-linear-to-r from-blue-500 to-blue-600 text-white rounded-full font-semibold shadow-lg hover:shadow-xl hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-300 transform hover:scale-105"
        >
          <span class="flex items-center gap-2">
            <z-icon
              zType="refresh-cw"
              class="group-hover:rotate-180 transition-transform duration-500 w-5 h-5"
            />
            Try Again
          </span>
        </button>
      </div>
    }

    <!-- End of Feed -->
    @if (!hasNext() && posts().length > 0) {
      <div class="text-center py-16 mt-4">
        <div
          class="inline-flex items-center gap-3 px-6 py-3 bg-white/80 backdrop-blur-sm rounded-full shadow-lg border border-gray-200"
        >
          <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"></div>
          <div class="text-gray-600 font-medium">You've reached the end</div>
          <div
            class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"
            style="animation-delay: 0.5s"
          ></div>
        </div>
        <p class="mt-4 text-gray-500 text-sm">That's all for now</p>
      </div>
    }
  </div>
</div>
